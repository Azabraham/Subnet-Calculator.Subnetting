It's all math.

Program is not fully optimized, but it gets it done. Functions avoided so the program looks like a sequence.
